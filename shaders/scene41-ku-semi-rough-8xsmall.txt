#include "trace-frag"

#include "bsdf"
#include "intersect"

void intersect(Ray ray, inout Intersection isect) {
    bboxIntersect(ray, vec2(0.0), vec2(1.79, 1.0), 3.0, isect);

    // relay wall
    lineIntersect(ray, vec2(1.2, -1.0), vec2(1.2, -0.2), 0.0, isect);

    // first hidden wall (mirror wall)
    lineIntersect(ray, vec2(0.4012461059190031, -0.4), vec2(0.39875389408099693, -0.3975077881619938), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3975077881619938), vec2(0.4012461059190031, -0.39501557632398754), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.39501557632398754), vec2(0.39875389408099693, -0.3925233644859813), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3925233644859813), vec2(0.4012461059190031, -0.39003115264797505), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.39003115264797505), vec2(0.39875389408099693, -0.3875389408099688), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3875389408099688), vec2(0.4012461059190031, -0.38504672897196257), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.38504672897196257), vec2(0.39875389408099693, -0.38255451713395633), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.38255451713395633), vec2(0.4012461059190031, -0.3800623052959501), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3800623052959501), vec2(0.39875389408099693, -0.37757009345794385), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.37757009345794385), vec2(0.4012461059190031, -0.3750778816199376), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3750778816199376), vec2(0.39875389408099693, -0.37258566978193136), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.37258566978193136), vec2(0.4012461059190031, -0.3700934579439251), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3700934579439251), vec2(0.39875389408099693, -0.3676012461059189), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3676012461059189), vec2(0.4012461059190031, -0.36510903426791264), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.36510903426791264), vec2(0.39875389408099693, -0.3626168224299064), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3626168224299064), vec2(0.4012461059190031, -0.36012461059190015), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.36012461059190015), vec2(0.39875389408099693, -0.3576323987538939), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3576323987538939), vec2(0.4012461059190031, -0.35514018691588767), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.35514018691588767), vec2(0.39875389408099693, -0.3526479750778814), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3526479750778814), vec2(0.4012461059190031, -0.3501557632398752), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3501557632398752), vec2(0.39875389408099693, -0.34766355140186894), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.34766355140186894), vec2(0.4012461059190031, -0.3451713395638627), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3451713395638627), vec2(0.39875389408099693, -0.34267912772585646), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.34267912772585646), vec2(0.4012461059190031, -0.3401869158878502), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3401869158878502), vec2(0.39875389408099693, -0.337694704049844), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.337694704049844), vec2(0.4012461059190031, -0.33520249221183773), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.33520249221183773), vec2(0.39875389408099693, -0.3327102803738315), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3327102803738315), vec2(0.4012461059190031, -0.33021806853582525), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.33021806853582525), vec2(0.39875389408099693, -0.327725856697819), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.327725856697819), vec2(0.4012461059190031, -0.32523364485981276), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.32523364485981276), vec2(0.39875389408099693, -0.3227414330218065), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3227414330218065), vec2(0.4012461059190031, -0.3202492211838003), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3202492211838003), vec2(0.39875389408099693, -0.31775700934579404), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.31775700934579404), vec2(0.4012461059190031, -0.3152647975077878), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3152647975077878), vec2(0.39875389408099693, -0.31277258566978156), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.31277258566978156), vec2(0.4012461059190031, -0.3102803738317753), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.3102803738317753), vec2(0.39875389408099693, -0.30778816199376907), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.30778816199376907), vec2(0.4012461059190031, -0.30529595015576283), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.30529595015576283), vec2(0.39875389408099693, -0.3028037383177566), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.3028037383177566), vec2(0.4012461059190031, -0.30031152647975035), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.30031152647975035), vec2(0.39875389408099693, -0.2978193146417441), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2978193146417441), vec2(0.4012461059190031, -0.29532710280373786), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.29532710280373786), vec2(0.39875389408099693, -0.2928348909657316), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2928348909657316), vec2(0.4012461059190031, -0.2903426791277254), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2903426791277254), vec2(0.39875389408099693, -0.28785046728971914), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.28785046728971914), vec2(0.4012461059190031, -0.2853582554517129), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2853582554517129), vec2(0.39875389408099693, -0.28286604361370665), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.28286604361370665), vec2(0.4012461059190031, -0.2803738317757004), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2803738317757004), vec2(0.39875389408099693, -0.27788161993769417), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.27788161993769417), vec2(0.4012461059190031, -0.2753894080996879), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2753894080996879), vec2(0.39875389408099693, -0.2728971962616817), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2728971962616817), vec2(0.4012461059190031, -0.27040498442367544), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.27040498442367544), vec2(0.39875389408099693, -0.2679127725856692), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2679127725856692), vec2(0.4012461059190031, -0.26542056074766296), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.26542056074766296), vec2(0.39875389408099693, -0.2629283489096567), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2629283489096567), vec2(0.4012461059190031, -0.2604361370716505), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2604361370716505), vec2(0.39875389408099693, -0.25794392523364423), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.25794392523364423), vec2(0.4012461059190031, -0.255451713395638), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.255451713395638), vec2(0.39875389408099693, -0.25295950155763175), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.25295950155763175), vec2(0.4012461059190031, -0.2504672897196255), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2504672897196255), vec2(0.39875389408099693, -0.24797507788161927), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.24797507788161927), vec2(0.4012461059190031, -0.24548286604361302), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.24548286604361302), vec2(0.39875389408099693, -0.24299065420560678), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.24299065420560678), vec2(0.4012461059190031, -0.24049844236760054), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.24049844236760054), vec2(0.39875389408099693, -0.2380062305295943), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2380062305295943), vec2(0.4012461059190031, -0.23551401869158806), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.23551401869158806), vec2(0.39875389408099693, -0.23302180685358181), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.23302180685358181), vec2(0.4012461059190031, -0.23052959501557557), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.23052959501557557), vec2(0.39875389408099693, -0.22803738317756933), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.22803738317756933), vec2(0.4012461059190031, -0.2255451713395631), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2255451713395631), vec2(0.39875389408099693, -0.22305295950155685), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.22305295950155685), vec2(0.4012461059190031, -0.2205607476635506), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.2205607476635506), vec2(0.39875389408099693, -0.21806853582554436), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.21806853582554436), vec2(0.4012461059190031, -0.21557632398753812), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.21557632398753812), vec2(0.39875389408099693, -0.21308411214953188), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.21308411214953188), vec2(0.4012461059190031, -0.21059190031152564), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.21059190031152564), vec2(0.39875389408099693, -0.2080996884735194), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2080996884735194), vec2(0.4012461059190031, -0.20560747663551315), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.20560747663551315), vec2(0.39875389408099693, -0.2031152647975069), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.2031152647975069), vec2(0.4012461059190031, -0.20062305295950067), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.20062305295950067), vec2(0.39875389408099693, -0.19813084112149443), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.19813084112149443), vec2(0.4012461059190031, -0.19563862928348819), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.19563862928348819), vec2(0.39875389408099693, -0.19314641744548194), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.19314641744548194), vec2(0.4012461059190031, -0.1906542056074757), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.1906542056074757), vec2(0.39875389408099693, -0.18816199376946946), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.18816199376946946), vec2(0.4012461059190031, -0.18566978193146322), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.18566978193146322), vec2(0.39875389408099693, -0.18317757009345698), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.18317757009345698), vec2(0.4012461059190031, -0.18068535825545073), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.18068535825545073), vec2(0.39875389408099693, -0.1781931464174445), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.1781931464174445), vec2(0.4012461059190031, -0.17570093457943825), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.17570093457943825), vec2(0.39875389408099693, -0.173208722741432), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.173208722741432), vec2(0.4012461059190031, -0.17071651090342577), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.17071651090342577), vec2(0.39875389408099693, -0.16822429906541952), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.16822429906541952), vec2(0.4012461059190031, -0.16573208722741328), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.16573208722741328), vec2(0.39875389408099693, -0.16323987538940704), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.16323987538940704), vec2(0.4012461059190031, -0.1607476635514008), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.1607476635514008), vec2(0.39875389408099693, -0.15825545171339456), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.15825545171339456), vec2(0.4012461059190031, -0.15576323987538832), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.15576323987538832), vec2(0.39875389408099693, -0.15327102803738207), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.15327102803738207), vec2(0.4012461059190031, -0.15077881619937583), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.15077881619937583), vec2(0.39875389408099693, -0.1482866043613696), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.1482866043613696), vec2(0.4012461059190031, -0.14579439252336335), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.14579439252336335), vec2(0.39875389408099693, -0.1433021806853571), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.1433021806853571), vec2(0.4012461059190031, -0.14080996884735086), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.14080996884735086), vec2(0.39875389408099693, -0.13831775700934462), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.13831775700934462), vec2(0.4012461059190031, -0.13582554517133838), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.13582554517133838), vec2(0.39875389408099693, -0.13333333333333214), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.13333333333333214), vec2(0.4012461059190031, -0.1308411214953259), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.1308411214953259), vec2(0.39875389408099693, -0.12834890965731965), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.12834890965731965), vec2(0.4012461059190031, -0.1258566978193134), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.1258566978193134), vec2(0.39875389408099693, -0.12336448598130718), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.12336448598130718), vec2(0.4012461059190031, -0.12087227414330096), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.12087227414330096), vec2(0.39875389408099693, -0.11838006230529473), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.11838006230529473), vec2(0.4012461059190031, -0.1158878504672885), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.1158878504672885), vec2(0.39875389408099693, -0.11339563862928227), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.11339563862928227), vec2(0.4012461059190031, -0.11090342679127604), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.11090342679127604), vec2(0.39875389408099693, -0.10841121495326982), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.10841121495326982), vec2(0.4012461059190031, -0.10591900311526359), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.10591900311526359), vec2(0.39875389408099693, -0.10342679127725736), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.10342679127725736), vec2(0.4012461059190031, -0.10093457943925113), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.10093457943925113), vec2(0.39875389408099693, -0.0984423676012449), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.0984423676012449), vec2(0.4012461059190031, -0.09595015576323868), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.09595015576323868), vec2(0.39875389408099693, -0.09345794392523245), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.09345794392523245), vec2(0.4012461059190031, -0.09096573208722622), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.09096573208722622), vec2(0.39875389408099693, -0.08847352024921999), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.08847352024921999), vec2(0.4012461059190031, -0.08598130841121376), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.08598130841121376), vec2(0.39875389408099693, -0.08348909657320754), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.08348909657320754), vec2(0.4012461059190031, -0.08099688473520131), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.08099688473520131), vec2(0.39875389408099693, -0.07850467289719508), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.07850467289719508), vec2(0.4012461059190031, -0.07601246105918885), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.07601246105918885), vec2(0.39875389408099693, -0.07352024922118262), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.07352024922118262), vec2(0.4012461059190031, -0.0710280373831764), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.0710280373831764), vec2(0.39875389408099693, -0.06853582554517017), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.06853582554517017), vec2(0.4012461059190031, -0.06604361370716394), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.06604361370716394), vec2(0.39875389408099693, -0.06355140186915771), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.06355140186915771), vec2(0.4012461059190031, -0.06105919003115148), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.06105919003115148), vec2(0.39875389408099693, -0.058566978193145255), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.058566978193145255), vec2(0.4012461059190031, -0.05607476635513903), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.05607476635513903), vec2(0.39875389408099693, -0.0535825545171328), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.0535825545171328), vec2(0.4012461059190031, -0.05109034267912657), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.05109034267912657), vec2(0.39875389408099693, -0.04859813084112034), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.04859813084112034), vec2(0.4012461059190031, -0.046105919003114115), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.046105919003114115), vec2(0.39875389408099693, -0.04361370716510789), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.04361370716510789), vec2(0.4012461059190031, -0.04112149532710166), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.04112149532710166), vec2(0.39875389408099693, -0.03862928348909543), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.03862928348909543), vec2(0.4012461059190031, -0.0361370716510892), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.0361370716510892), vec2(0.39875389408099693, -0.033644859813082975), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.033644859813082975), vec2(0.4012461059190031, -0.031152647975076744), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.031152647975076744), vec2(0.39875389408099693, -0.028660436137070512), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.028660436137070512), vec2(0.4012461059190031, -0.02616822429906428), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.02616822429906428), vec2(0.39875389408099693, -0.02367601246105805), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.02367601246105805), vec2(0.4012461059190031, -0.021183800623051818), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.021183800623051818), vec2(0.39875389408099693, -0.018691588785045586), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.018691588785045586), vec2(0.4012461059190031, -0.016199376947039355), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.016199376947039355), vec2(0.39875389408099693, -0.013707165109033123), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.013707165109033123), vec2(0.4012461059190031, -0.011214953271026892), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.011214953271026892), vec2(0.39875389408099693, -0.00872274143302066), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.00872274143302066), vec2(0.4012461059190031, -0.0062305295950144295), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.0062305295950144295), vec2(0.39875389408099693, -0.003738317757008199), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, -0.003738317757008199), vec2(0.4012461059190031, -0.0012461059190019682), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, -0.0012461059190019682), vec2(0.39875389408099693, 0.0012461059190042624), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.0012461059190042624), vec2(0.4012461059190031, 0.003738317757010493), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.003738317757010493), vec2(0.39875389408099693, 0.006230529595016724), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.006230529595016724), vec2(0.4012461059190031, 0.008722741433022953), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.008722741433022953), vec2(0.39875389408099693, 0.011214953271029185), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.011214953271029185), vec2(0.4012461059190031, 0.013707165109035416), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.013707165109035416), vec2(0.39875389408099693, 0.016199376947041648), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.016199376947041648), vec2(0.4012461059190031, 0.01869158878504788), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.01869158878504788), vec2(0.39875389408099693, 0.02118380062305411), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.02118380062305411), vec2(0.4012461059190031, 0.023676012461060342), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.023676012461060342), vec2(0.39875389408099693, 0.026168224299066574), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.026168224299066574), vec2(0.4012461059190031, 0.028660436137072805), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.028660436137072805), vec2(0.39875389408099693, 0.031152647975079037), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.031152647975079037), vec2(0.4012461059190031, 0.033644859813085265), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.033644859813085265), vec2(0.39875389408099693, 0.03613707165109149), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.03613707165109149), vec2(0.4012461059190031, 0.03862928348909772), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.03862928348909772), vec2(0.39875389408099693, 0.04112149532710395), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.04112149532710395), vec2(0.4012461059190031, 0.04361370716511018), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.04361370716511018), vec2(0.39875389408099693, 0.046105919003116405), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.046105919003116405), vec2(0.4012461059190031, 0.04859813084112263), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.04859813084112263), vec2(0.39875389408099693, 0.05109034267912886), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.05109034267912886), vec2(0.4012461059190031, 0.05358255451713509), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.05358255451713509), vec2(0.39875389408099693, 0.05607476635514132), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.05607476635514132), vec2(0.4012461059190031, 0.058566978193147545), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.058566978193147545), vec2(0.39875389408099693, 0.06105919003115377), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.06105919003115377), vec2(0.4012461059190031, 0.06355140186916), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.06355140186916), vec2(0.39875389408099693, 0.06604361370716623), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.06604361370716623), vec2(0.4012461059190031, 0.06853582554517246), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.06853582554517246), vec2(0.39875389408099693, 0.07102803738317869), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.07102803738317869), vec2(0.4012461059190031, 0.07352024922118491), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.07352024922118491), vec2(0.39875389408099693, 0.07601246105919114), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.07601246105919114), vec2(0.4012461059190031, 0.07850467289719737), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.07850467289719737), vec2(0.39875389408099693, 0.0809968847352036), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.0809968847352036), vec2(0.4012461059190031, 0.08348909657320983), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.08348909657320983), vec2(0.39875389408099693, 0.08598130841121605), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.08598130841121605), vec2(0.4012461059190031, 0.08847352024922228), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.08847352024922228), vec2(0.39875389408099693, 0.09096573208722851), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.09096573208722851), vec2(0.4012461059190031, 0.09345794392523474), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.09345794392523474), vec2(0.39875389408099693, 0.09595015576324097), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.09595015576324097), vec2(0.4012461059190031, 0.0984423676012472), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.0984423676012472), vec2(0.39875389408099693, 0.10093457943925342), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.10093457943925342), vec2(0.4012461059190031, 0.10342679127725965), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.10342679127725965), vec2(0.39875389408099693, 0.10591900311526588), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.10591900311526588), vec2(0.4012461059190031, 0.1084112149532721), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.1084112149532721), vec2(0.39875389408099693, 0.11090342679127833), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.11090342679127833), vec2(0.4012461059190031, 0.11339563862928456), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.11339563862928456), vec2(0.39875389408099693, 0.11588785046729079), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.11588785046729079), vec2(0.4012461059190031, 0.11838006230529702), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.11838006230529702), vec2(0.39875389408099693, 0.12087227414330325), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.12087227414330325), vec2(0.4012461059190031, 0.12336448598130947), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.12336448598130947), vec2(0.39875389408099693, 0.12585669781931572), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.12585669781931572), vec2(0.4012461059190031, 0.12834890965732196), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.12834890965732196), vec2(0.39875389408099693, 0.1308411214953282), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.1308411214953282), vec2(0.4012461059190031, 0.13333333333333444), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.13333333333333444), vec2(0.39875389408099693, 0.13582554517134068), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.13582554517134068), vec2(0.4012461059190031, 0.13831775700934693), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.13831775700934693), vec2(0.39875389408099693, 0.14080996884735317), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.14080996884735317), vec2(0.4012461059190031, 0.1433021806853594), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.1433021806853594), vec2(0.39875389408099693, 0.14579439252336565), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.14579439252336565), vec2(0.4012461059190031, 0.1482866043613719), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.1482866043613719), vec2(0.39875389408099693, 0.15077881619937814), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.15077881619937814), vec2(0.4012461059190031, 0.15327102803738438), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.15327102803738438), vec2(0.39875389408099693, 0.15576323987539062), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.15576323987539062), vec2(0.4012461059190031, 0.15825545171339686), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.15825545171339686), vec2(0.39875389408099693, 0.1607476635514031), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.1607476635514031), vec2(0.4012461059190031, 0.16323987538940934), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.16323987538940934), vec2(0.39875389408099693, 0.1657320872274156), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.1657320872274156), vec2(0.4012461059190031, 0.16822429906542183), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.16822429906542183), vec2(0.39875389408099693, 0.17071651090342807), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.17071651090342807), vec2(0.4012461059190031, 0.1732087227414343), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.1732087227414343), vec2(0.39875389408099693, 0.17570093457944055), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.17570093457944055), vec2(0.4012461059190031, 0.1781931464174468), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.1781931464174468), vec2(0.39875389408099693, 0.18068535825545304), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.18068535825545304), vec2(0.4012461059190031, 0.18317757009345928), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.18317757009345928), vec2(0.39875389408099693, 0.18566978193146552), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.18566978193146552), vec2(0.4012461059190031, 0.18816199376947176), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.18816199376947176), vec2(0.39875389408099693, 0.190654205607478), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.190654205607478), vec2(0.4012461059190031, 0.19314641744548425), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.19314641744548425), vec2(0.39875389408099693, 0.1956386292834905), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.1956386292834905), vec2(0.4012461059190031, 0.19813084112149673), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.19813084112149673), vec2(0.39875389408099693, 0.20062305295950297), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.20062305295950297), vec2(0.4012461059190031, 0.20311526479750922), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.20311526479750922), vec2(0.39875389408099693, 0.20560747663551546), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.20560747663551546), vec2(0.4012461059190031, 0.2080996884735217), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2080996884735217), vec2(0.39875389408099693, 0.21059190031152794), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.21059190031152794), vec2(0.4012461059190031, 0.21308411214953418), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.21308411214953418), vec2(0.39875389408099693, 0.21557632398754042), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.21557632398754042), vec2(0.4012461059190031, 0.21806853582554667), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.21806853582554667), vec2(0.39875389408099693, 0.2205607476635529), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.2205607476635529), vec2(0.4012461059190031, 0.22305295950155915), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.22305295950155915), vec2(0.39875389408099693, 0.2255451713395654), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.2255451713395654), vec2(0.4012461059190031, 0.22803738317757163), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.22803738317757163), vec2(0.39875389408099693, 0.23052959501557788), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.23052959501557788), vec2(0.4012461059190031, 0.23302180685358412), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.23302180685358412), vec2(0.39875389408099693, 0.23551401869159036), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.23551401869159036), vec2(0.4012461059190031, 0.2380062305295966), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2380062305295966), vec2(0.39875389408099693, 0.24049844236760284), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.24049844236760284), vec2(0.4012461059190031, 0.24299065420560909), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.24299065420560909), vec2(0.39875389408099693, 0.24548286604361533), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.24548286604361533), vec2(0.4012461059190031, 0.24797507788162157), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.24797507788162157), vec2(0.39875389408099693, 0.2504672897196278), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.2504672897196278), vec2(0.4012461059190031, 0.252959501557634), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.252959501557634), vec2(0.39875389408099693, 0.25545171339564027), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.25545171339564027), vec2(0.4012461059190031, 0.2579439252336465), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2579439252336465), vec2(0.39875389408099693, 0.26043613707165275), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.26043613707165275), vec2(0.4012461059190031, 0.262928348909659), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.262928348909659), vec2(0.39875389408099693, 0.26542056074766524), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.26542056074766524), vec2(0.4012461059190031, 0.2679127725856715), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2679127725856715), vec2(0.39875389408099693, 0.2704049844236777), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.2704049844236777), vec2(0.4012461059190031, 0.27289719626168396), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.27289719626168396), vec2(0.39875389408099693, 0.2753894080996902), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.2753894080996902), vec2(0.4012461059190031, 0.27788161993769644), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.27788161993769644), vec2(0.39875389408099693, 0.2803738317757027), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.2803738317757027), vec2(0.4012461059190031, 0.28286604361370893), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.28286604361370893), vec2(0.39875389408099693, 0.28535825545171517), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.28535825545171517), vec2(0.4012461059190031, 0.2878504672897214), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2878504672897214), vec2(0.39875389408099693, 0.29034267912772765), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.29034267912772765), vec2(0.4012461059190031, 0.2928348909657339), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2928348909657339), vec2(0.39875389408099693, 0.29532710280374014), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.29532710280374014), vec2(0.4012461059190031, 0.2978193146417464), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.2978193146417464), vec2(0.39875389408099693, 0.3003115264797526), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3003115264797526), vec2(0.4012461059190031, 0.30280373831775886), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.30280373831775886), vec2(0.39875389408099693, 0.3052959501557651), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3052959501557651), vec2(0.4012461059190031, 0.30778816199377135), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.30778816199377135), vec2(0.39875389408099693, 0.3102803738317776), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3102803738317776), vec2(0.4012461059190031, 0.31277258566978383), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.31277258566978383), vec2(0.39875389408099693, 0.3152647975077901), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3152647975077901), vec2(0.4012461059190031, 0.3177570093457963), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3177570093457963), vec2(0.39875389408099693, 0.32024922118380256), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.32024922118380256), vec2(0.4012461059190031, 0.3227414330218088), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3227414330218088), vec2(0.39875389408099693, 0.32523364485981504), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.32523364485981504), vec2(0.4012461059190031, 0.3277258566978213), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3277258566978213), vec2(0.39875389408099693, 0.3302180685358275), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3302180685358275), vec2(0.4012461059190031, 0.33271028037383377), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.33271028037383377), vec2(0.39875389408099693, 0.33520249221184), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.33520249221184), vec2(0.4012461059190031, 0.33769470404984625), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.33769470404984625), vec2(0.39875389408099693, 0.3401869158878525), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3401869158878525), vec2(0.4012461059190031, 0.34267912772585873), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.34267912772585873), vec2(0.39875389408099693, 0.345171339563865), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.345171339563865), vec2(0.4012461059190031, 0.3476635514018712), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3476635514018712), vec2(0.39875389408099693, 0.35015576323987746), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.35015576323987746), vec2(0.4012461059190031, 0.3526479750778837), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3526479750778837), vec2(0.39875389408099693, 0.35514018691588994), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.35514018691588994), vec2(0.4012461059190031, 0.3576323987538962), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3576323987538962), vec2(0.39875389408099693, 0.3601246105919024), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3601246105919024), vec2(0.4012461059190031, 0.36261682242990867), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.36261682242990867), vec2(0.39875389408099693, 0.3651090342679149), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3651090342679149), vec2(0.4012461059190031, 0.36760124610592115), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.36760124610592115), vec2(0.39875389408099693, 0.3700934579439274), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3700934579439274), vec2(0.4012461059190031, 0.37258566978193364), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.37258566978193364), vec2(0.39875389408099693, 0.3750778816199399), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3750778816199399), vec2(0.4012461059190031, 0.3775700934579461), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3775700934579461), vec2(0.39875389408099693, 0.38006230529595236), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.38006230529595236), vec2(0.4012461059190031, 0.3825545171339586), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3825545171339586), vec2(0.39875389408099693, 0.38504672897196485), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.38504672897196485), vec2(0.4012461059190031, 0.3875389408099711), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3875389408099711), vec2(0.39875389408099693, 0.39003115264797733), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.39003115264797733), vec2(0.4012461059190031, 0.3925233644859836), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.3925233644859836), vec2(0.39875389408099693, 0.3950155763239898), 0.0, isect);
    lineIntersect(ray, vec2(0.39875389408099693, 0.3950155763239898), vec2(0.4012461059190031, 0.39750778816199606), 0.0, isect);
    lineIntersect(ray, vec2(0.4012461059190031, 0.39750778816199606), vec2(0.39875389408099693, 0.4000000000000023), 0.0, isect);

    // doubly-hidden wall
    lineIntersect(ray, vec2(1.2031055900621117, 0.0), vec2(1.1968944099378882, 0.006211180124223602), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.006211180124223602), vec2(1.2031055900621117, 0.012422360248447204), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.012422360248447204), vec2(1.1968944099378882, 0.018633540372670808), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.018633540372670808), vec2(1.2031055900621117, 0.024844720496894408), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.024844720496894408), vec2(1.1968944099378882, 0.03105590062111801), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.03105590062111801), vec2(1.2031055900621117, 0.03726708074534161), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.03726708074534161), vec2(1.1968944099378882, 0.04347826086956521), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.04347826086956521), vec2(1.2031055900621117, 0.04968944099378881), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.04968944099378881), vec2(1.1968944099378882, 0.05590062111801241), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.05590062111801241), vec2(1.2031055900621117, 0.06211180124223601), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.06211180124223601), vec2(1.1968944099378882, 0.06832298136645962), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.06832298136645962), vec2(1.2031055900621117, 0.07453416149068322), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.07453416149068322), vec2(1.1968944099378882, 0.08074534161490682), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.08074534161490682), vec2(1.2031055900621117, 0.08695652173913042), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.08695652173913042), vec2(1.1968944099378882, 0.09316770186335402), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.09316770186335402), vec2(1.2031055900621117, 0.09937888198757762), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.09937888198757762), vec2(1.1968944099378882, 0.10559006211180122), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.10559006211180122), vec2(1.2031055900621117, 0.11180124223602482), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.11180124223602482), vec2(1.1968944099378882, 0.11801242236024842), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.11801242236024842), vec2(1.2031055900621117, 0.12422360248447202), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.12422360248447202), vec2(1.1968944099378882, 0.13043478260869562), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.13043478260869562), vec2(1.2031055900621117, 0.13664596273291924), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.13664596273291924), vec2(1.1968944099378882, 0.14285714285714285), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.14285714285714285), vec2(1.2031055900621117, 0.14906832298136646), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.14906832298136646), vec2(1.1968944099378882, 0.15527950310559008), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.15527950310559008), vec2(1.2031055900621117, 0.1614906832298137), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.1614906832298137), vec2(1.1968944099378882, 0.1677018633540373), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.1677018633540373), vec2(1.2031055900621117, 0.17391304347826092), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.17391304347826092), vec2(1.1968944099378882, 0.18012422360248453), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.18012422360248453), vec2(1.2031055900621117, 0.18633540372670815), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.18633540372670815), vec2(1.1968944099378882, 0.19254658385093176), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.19254658385093176), vec2(1.2031055900621117, 0.19875776397515538), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.19875776397515538), vec2(1.1968944099378882, 0.204968944099379), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.204968944099379), vec2(1.2031055900621117, 0.2111801242236026), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.2111801242236026), vec2(1.1968944099378882, 0.21739130434782622), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.21739130434782622), vec2(1.2031055900621117, 0.22360248447204983), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.22360248447204983), vec2(1.1968944099378882, 0.22981366459627345), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.22981366459627345), vec2(1.2031055900621117, 0.23602484472049706), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.23602484472049706), vec2(1.1968944099378882, 0.24223602484472068), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.24223602484472068), vec2(1.2031055900621117, 0.2484472049689443), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.2484472049689443), vec2(1.1968944099378882, 0.2546583850931679), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.2546583850931679), vec2(1.2031055900621117, 0.2608695652173915), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.2608695652173915), vec2(1.1968944099378882, 0.26708074534161513), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.26708074534161513), vec2(1.2031055900621117, 0.27329192546583875), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.27329192546583875), vec2(1.1968944099378882, 0.27950310559006236), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.27950310559006236), vec2(1.2031055900621117, 0.285714285714286), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.285714285714286), vec2(1.1968944099378882, 0.2919254658385096), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.2919254658385096), vec2(1.2031055900621117, 0.2981366459627332), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.2981366459627332), vec2(1.1968944099378882, 0.3043478260869568), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.3043478260869568), vec2(1.2031055900621117, 0.31055900621118043), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.31055900621118043), vec2(1.1968944099378882, 0.31677018633540405), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.31677018633540405), vec2(1.2031055900621117, 0.32298136645962766), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.32298136645962766), vec2(1.1968944099378882, 0.3291925465838513), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.3291925465838513), vec2(1.2031055900621117, 0.3354037267080749), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.3354037267080749), vec2(1.1968944099378882, 0.3416149068322985), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.3416149068322985), vec2(1.2031055900621117, 0.3478260869565221), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.3478260869565221), vec2(1.1968944099378882, 0.35403726708074573), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.35403726708074573), vec2(1.2031055900621117, 0.36024844720496935), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.36024844720496935), vec2(1.1968944099378882, 0.36645962732919296), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.36645962732919296), vec2(1.2031055900621117, 0.3726708074534166), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.3726708074534166), vec2(1.1968944099378882, 0.3788819875776402), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.3788819875776402), vec2(1.2031055900621117, 0.3850931677018638), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.3850931677018638), vec2(1.1968944099378882, 0.3913043478260874), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.3913043478260874), vec2(1.2031055900621117, 0.39751552795031103), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.39751552795031103), vec2(1.1968944099378882, 0.40372670807453465), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.40372670807453465), vec2(1.2031055900621117, 0.40993788819875826), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.40993788819875826), vec2(1.1968944099378882, 0.4161490683229819), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.4161490683229819), vec2(1.2031055900621117, 0.4223602484472055), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.4223602484472055), vec2(1.1968944099378882, 0.4285714285714291), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.4285714285714291), vec2(1.2031055900621117, 0.4347826086956527), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.4347826086956527), vec2(1.1968944099378882, 0.44099378881987633), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.44099378881987633), vec2(1.2031055900621117, 0.44720496894409995), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.44720496894409995), vec2(1.1968944099378882, 0.45341614906832356), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.45341614906832356), vec2(1.2031055900621117, 0.4596273291925472), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.4596273291925472), vec2(1.1968944099378882, 0.4658385093167708), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.4658385093167708), vec2(1.2031055900621117, 0.4720496894409944), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.4720496894409944), vec2(1.1968944099378882, 0.478260869565218), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.478260869565218), vec2(1.2031055900621117, 0.48447204968944163), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.48447204968944163), vec2(1.1968944099378882, 0.49068322981366524), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.49068322981366524), vec2(1.2031055900621117, 0.49689440993788886), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.49689440993788886), vec2(1.1968944099378882, 0.5031055900621124), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5031055900621124), vec2(1.2031055900621117, 0.509316770186336), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.509316770186336), vec2(1.1968944099378882, 0.5155279503105596), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5155279503105596), vec2(1.2031055900621117, 0.5217391304347833), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.5217391304347833), vec2(1.1968944099378882, 0.5279503105590069), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5279503105590069), vec2(1.2031055900621117, 0.5341614906832305), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.5341614906832305), vec2(1.1968944099378882, 0.5403726708074541), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5403726708074541), vec2(1.2031055900621117, 0.5465838509316777), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.5465838509316777), vec2(1.1968944099378882, 0.5527950310559013), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5527950310559013), vec2(1.2031055900621117, 0.559006211180125), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.559006211180125), vec2(1.1968944099378882, 0.5652173913043486), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5652173913043486), vec2(1.2031055900621117, 0.5714285714285722), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.5714285714285722), vec2(1.1968944099378882, 0.5776397515527958), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.5776397515527958), vec2(1.2031055900621117, 0.5838509316770194), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.5838509316770194), vec2(1.1968944099378882, 0.590062111801243), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.590062111801243), vec2(1.2031055900621117, 0.5962732919254666), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.5962732919254666), vec2(1.1968944099378882, 0.6024844720496902), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6024844720496902), vec2(1.2031055900621117, 0.6086956521739139), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6086956521739139), vec2(1.1968944099378882, 0.6149068322981375), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6149068322981375), vec2(1.2031055900621117, 0.6211180124223611), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6211180124223611), vec2(1.1968944099378882, 0.6273291925465847), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6273291925465847), vec2(1.2031055900621117, 0.6335403726708083), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6335403726708083), vec2(1.1968944099378882, 0.6397515527950319), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6397515527950319), vec2(1.2031055900621117, 0.6459627329192555), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6459627329192555), vec2(1.1968944099378882, 0.6521739130434792), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6521739130434792), vec2(1.2031055900621117, 0.6583850931677028), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6583850931677028), vec2(1.1968944099378882, 0.6645962732919264), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6645962732919264), vec2(1.2031055900621117, 0.67080745341615), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.67080745341615), vec2(1.1968944099378882, 0.6770186335403736), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6770186335403736), vec2(1.2031055900621117, 0.6832298136645972), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6832298136645972), vec2(1.1968944099378882, 0.6894409937888208), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.6894409937888208), vec2(1.2031055900621117, 0.6956521739130445), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.6956521739130445), vec2(1.1968944099378882, 0.7018633540372681), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7018633540372681), vec2(1.2031055900621117, 0.7080745341614917), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7080745341614917), vec2(1.1968944099378882, 0.7142857142857153), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7142857142857153), vec2(1.2031055900621117, 0.7204968944099389), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7204968944099389), vec2(1.1968944099378882, 0.7267080745341625), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7267080745341625), vec2(1.2031055900621117, 0.7329192546583861), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7329192546583861), vec2(1.1968944099378882, 0.7391304347826098), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7391304347826098), vec2(1.2031055900621117, 0.7453416149068334), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7453416149068334), vec2(1.1968944099378882, 0.751552795031057), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.751552795031057), vec2(1.2031055900621117, 0.7577639751552806), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7577639751552806), vec2(1.1968944099378882, 0.7639751552795042), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7639751552795042), vec2(1.2031055900621117, 0.7701863354037278), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7701863354037278), vec2(1.1968944099378882, 0.7763975155279514), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7763975155279514), vec2(1.2031055900621117, 0.7826086956521751), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7826086956521751), vec2(1.1968944099378882, 0.7888198757763987), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.7888198757763987), vec2(1.2031055900621117, 0.7950310559006223), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.7950310559006223), vec2(1.1968944099378882, 0.8012422360248459), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8012422360248459), vec2(1.2031055900621117, 0.8074534161490695), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8074534161490695), vec2(1.1968944099378882, 0.8136645962732931), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8136645962732931), vec2(1.2031055900621117, 0.8198757763975167), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8198757763975167), vec2(1.1968944099378882, 0.8260869565217404), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8260869565217404), vec2(1.2031055900621117, 0.832298136645964), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.832298136645964), vec2(1.1968944099378882, 0.8385093167701876), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8385093167701876), vec2(1.2031055900621117, 0.8447204968944112), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8447204968944112), vec2(1.1968944099378882, 0.8509316770186348), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8509316770186348), vec2(1.2031055900621117, 0.8571428571428584), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8571428571428584), vec2(1.1968944099378882, 0.863354037267082), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.863354037267082), vec2(1.2031055900621117, 0.8695652173913057), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8695652173913057), vec2(1.1968944099378882, 0.8757763975155293), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8757763975155293), vec2(1.2031055900621117, 0.8819875776397529), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8819875776397529), vec2(1.1968944099378882, 0.8881987577639765), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.8881987577639765), vec2(1.2031055900621117, 0.8944099378882001), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.8944099378882001), vec2(1.1968944099378882, 0.9006211180124237), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9006211180124237), vec2(1.2031055900621117, 0.9068322981366473), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9068322981366473), vec2(1.1968944099378882, 0.913043478260871), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.913043478260871), vec2(1.2031055900621117, 0.9192546583850946), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9192546583850946), vec2(1.1968944099378882, 0.9254658385093182), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9254658385093182), vec2(1.2031055900621117, 0.9316770186335418), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9316770186335418), vec2(1.1968944099378882, 0.9378881987577654), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9378881987577654), vec2(1.2031055900621117, 0.944099378881989), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.944099378881989), vec2(1.1968944099378882, 0.9503105590062126), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9503105590062126), vec2(1.2031055900621117, 0.9565217391304363), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9565217391304363), vec2(1.1968944099378882, 0.9627329192546599), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9627329192546599), vec2(1.2031055900621117, 0.9689440993788835), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9689440993788835), vec2(1.1968944099378882, 0.9751552795031071), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9751552795031071), vec2(1.2031055900621117, 0.9813664596273307), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9813664596273307), vec2(1.1968944099378882, 0.9875776397515543), 0.0, isect);
    lineIntersect(ray, vec2(1.1968944099378882, 0.9875776397515543), vec2(1.2031055900621117, 0.9937888198757779), 0.0, isect);
    lineIntersect(ray, vec2(1.2031055900621117, 0.9937888198757779), vec2(1.1968944099378882, 1.0000000000000016), 0.0, isect);
}

vec2 sample(inout vec4 state, Intersection isect, float lambda, vec2 wiLocal, inout vec3 throughput, out float tMult) {
    tMult = 1.0;
    if (isect.mat == 1.0) {
        return sampleRoughMirror(state, wiLocal, throughput, 0.5);
        float ior = sqrt(sellmeierIor(vec3(1.0396, 0.2318, 1.0105), vec3(0.0060, 0.0200, 103.56), lambda));
        if (wiLocal.y < 0.0) {
            // The ray comes from inside the dielectric material - it will take longer times
            tMult = ior;
        }
        return sampleDielectric(state, wiLocal, ior);
    } else if (isect.mat == 2.0) {
        return sampleMirror(wiLocal);
    } else if (isect.mat == 3.0) {
        throughput *= vec3(0.0);
        return sampleDiffuse(state, wiLocal);
    } else {
        throughput *= vec3(0.5);
        return sampleDiffuse(state, wiLocal);
    }
}